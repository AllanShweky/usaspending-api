{
  "final_name": "recipient_lookup_view",
  "refresh": true,
  "matview_sql": [
    "SELECT",
    "  MD5(UPPER(CONCAT(duns.awardee_or_recipient_uniqu, duns.legal_business_name)))::uuid AS recipient_hash,",
    "  duns.legal_business_name,",
    "  duns.awardee_or_recipient_uniqu AS duns",
    "FROM duns",
    "LEFT OUTER JOIN legal_entity ON duns.awardee_or_recipient_uniqu = legal_entity.recipient_unique_id",
    "GROUP BY duns.legal_business_name, duns.awardee_or_recipient_uniqu",
    "-- Adding Non-DUNS Recipients which are not included in SAM for obvious reasons",
    "UNION",
    "SELECT MD5('-1MULTIPLE RECIPIENTS')::uuid AS recipient_hash, 'MULTIPLE RECIPIENTS' AS legal_business_name, '-1' AS duns",
    "UNION",
    "SELECT MD5('-2REDACTED DUE TO PII')::uuid AS recipient_hash, 'REDACTED DUE TO PII' AS legal_business_name, '-2' AS duns",
    "UNION",
    "SELECT MD5('-3MULTIPLE FOREIGN RECIPIENTS')::uuid AS recipient_hash, 'MULTIPLE FOREIGN RECIPIENTS' AS legal_business_name, '-3' AS duns",
    "UNION",
    "SELECT MD5('-4PRIVATE INDIVIDUAL')::uuid AS recipient_hash, 'PRIVATE INDIVIDUAL' AS legal_business_name, '-4' AS duns",
    "UNION",
    "SELECT MD5('-5INDIVIDUAL RECIPIENT')::uuid AS recipient_hash, 'INDIVIDUAL RECIPIENT' AS legal_business_name, '-5' AS duns"
  ],
  "indexes": [
    {
      "name": "unique_hash",
      "unique": true,
      "columns": [{"name": "recipient_hash"}]
    }, {
      "name": "unique_duns",
      "unique": true,
      "columns": [{"name": "duns"}]
    }, {
      "name": "recipient_name",
      "columns": [{"name": "legal_business_name"}]
    }
  ]
}
