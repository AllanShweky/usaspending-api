# -*- coding: utf-8 -*-
# Generated by Django 1.10.1 on 2017-01-10 20:11
from __future__ import unicode_literals

from django.db import migrations, models


def update_type_descriptions(apps, schema_editor):
    # Use award model at time of migration
    Award = apps.get_model("awards", "Award")
    for awrd in Award.objects.all():
        awrd.type_description = get_type_description(awrd.type)
        awrd.save()


def get_type_description(atype):
    # We keep the award types and functionality here for historical continuity
    AWARD_TYPES = (
        ('U', 'Unknown Type'),
        ('02', 'Block Grant'),
        ('03', 'Formula Grant'),
        ('04', 'Project Grant'),
        ('05', 'Cooperative Agreement'),
        ('06', 'Direct Payment for Specified Use'),
        ('07', 'Direct Loan'),
        ('08', 'Guaranteed/Insured Loan'),
        ('09', 'Insurance'),
        ('10', 'Direct Payment unrestricted'),
        ('11', 'Other'),
        ('C', 'Contract'),
        ('G', 'Grant'),
        ('DP', 'Direct Payment'),
        ('L', 'Loan'),
    )
    description = [item for item in AWARD_TYPES if item[0] == atype]
    if len(description) == 0:
        return "Unknown Type"
    else:
        return description[0][1]


class Migration(migrations.Migration):

    dependencies = [
        ('awards', '0050_award_type_description'),
    ]

    operations = [
        migrations.RunPython(update_type_descriptions),
    ]
